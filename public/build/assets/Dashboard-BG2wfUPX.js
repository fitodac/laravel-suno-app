import{r as d,j as e,n as k}from"./app-BL5MU1ub.js";import{L as P}from"./Layout-BNTuHHey.js";import{t as V}from"./translations-gWKnqGb7.js";import{P as $}from"./index-CkAPsS__.js";import{b as N,s as _}from"./chunk-DBLREEYE-k5beFU79.js";import{t as D,c as R,m as L,u as T,o as B,f as H}from"./chunk-XHQUSKIE-D4as8MM8.js";import{t as M}from"./chunk-ATAY3LCU-0pQGZUAg.js";import{s as O}from"./chunk-VMWQTXAV-CmOJJGNI.js";import{c as y}from"./chunk-3XVMTUU7-Dp_cF4cz.js";import{i as q}from"./chunk-NK4BRF7C-cG93tRQM.js";import"./useColorMode-BEg4eCOE.js";import"./template.executive.config-JRgdiSJO.js";import"./chunk-44JHHBS2-BriGgij3.js";import"./Item-vlEXo0Zk.js";import"./FocusScope-Bl5fcGfa.js";import"./focusSafely-C6wh2g3D.js";import"./usePress-CYqZ7Kvo.js";import"./VisuallyHidden-8nf4bjXZ.js";import"./useFormValidationState-GSGWOKt_.js";import"./getChildNodes-BuxFdcox.js";import"./useDialog-BTerbq__.js";import"./useLabels-D90GRlDd.js";import"./chunk-6NL67ZRH-Bv4xzwpt.js";import"./index-BKyyixf6.js";import"./chunk-QXREVWCS-C6-bBqo7.js";import"./index-Cijx77Os.js";import"./extend-tailwind-merge-DDA0jNcl.js";import"./chunk-NQM3AZQR-LXh0D-Rm.js";import"./useToggleState-dObIv4S-.js";var W=["data-[top-scroll=true]:[mask-image:linear-gradient(0deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[bottom-scroll=true]:[mask-image:linear-gradient(180deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[top-bottom-scroll=true]:[mask-image:linear-gradient(#000,#000,transparent_0,#000_var(--scroll-shadow-size),#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]"],A=["data-[left-scroll=true]:[mask-image:linear-gradient(270deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[right-scroll=true]:[mask-image:linear-gradient(90deg,#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]","data-[left-right-scroll=true]:[mask-image:linear-gradient(to_right,#000,#000,transparent_0,#000_var(--scroll-shadow-size),#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]"],C=D({base:[],variants:{orientation:{vertical:["overflow-y-auto",...W],horizontal:["overflow-x-auto",...A]},hideScrollBar:{true:"scrollbar-hide",false:""}},defaultVariants:{orientation:"vertical",hideScrollBar:!1}});function F(r={}){const{domRef:o,isEnabled:a=!0,overflowCheck:s="vertical",visibility:i="auto",offset:n=0,onVisibilityChange:p,updateDeps:c=[]}=r,u=d.useRef(i);d.useEffect(()=>{const t=o==null?void 0:o.current;if(!t||!a)return;const S=(m,h,x,f,g)=>{if(i==="auto"){const j=`${f}${R(g)}Scroll`;h&&x?(t.dataset[j]="true",t.removeAttribute(`data-${f}-scroll`),t.removeAttribute(`data-${g}-scroll`)):(t.dataset[`${f}Scroll`]=h.toString(),t.dataset[`${g}Scroll`]=x.toString(),t.removeAttribute(`data-${f}-${g}-scroll`))}else{const j=h&&x?"both":h?f:x?g:"none";j!==u.current&&(p==null||p(j),u.current=j)}},w=()=>{const m=[{type:"vertical",prefix:"top",suffix:"bottom"},{type:"horizontal",prefix:"left",suffix:"right"}];for(const{type:h,prefix:x,suffix:f}of m)if(s===h||s==="both"){const g=h==="vertical"?t.scrollTop>n:t.scrollLeft>n,j=h==="vertical"?t.scrollTop+t.clientHeight+n<t.scrollHeight:t.scrollLeft+t.clientWidth+n<t.scrollWidth;S(h,g,j,x,f)}},v=()=>{["top","bottom","top-bottom","left","right","left-right"].forEach(m=>{t.removeAttribute(`data-${m}-scroll`)})};return w(),t.addEventListener("scroll",w),i!=="auto"&&(v(),i==="both"?(t.dataset.topBottomScroll=String(s==="vertical"),t.dataset.leftRightScroll=String(s==="horizontal")):(t.dataset.topBottomScroll="false",t.dataset.leftRightScroll="false",["top","bottom","left","right"].forEach(m=>{t.dataset[`${m}Scroll`]=String(i===m)}))),()=>{t.removeEventListener("scroll",w),v()}},[...c,a,i,s,p,o])}function G(r){var o;const[a,s]=L(r,C.variantKeys),{ref:i,as:n,children:p,className:c,style:u,size:t=40,offset:S=0,visibility:w="auto",isEnabled:v=!0,onVisibilityChange:m,...h}=a,x=n||"div",f=T(i);F({domRef:f,offset:S,visibility:w,isEnabled:v,onVisibilityChange:m,updateDeps:[p],overflowCheck:(o=r.orientation)!=null?o:"vertical"});const g=d.useMemo(()=>C({...s,className:c}),[B(s),c]);return{Component:x,styles:g,domRef:f,children:p,getBaseProps:(l={})=>{var b;return{ref:f,className:g,"data-orientation":(b=r.orientation)!=null?b:"vertical",style:{"--scroll-shadow-size":`${t}px`,...u,...l.style},...h,...l}}}}var E=H((r,o)=>{const{Component:a,children:s,getBaseProps:i}=G({...r,ref:o});return e.jsx(a,{...i(),children:s})});E.displayName="NextUI.ScrollShadow";var Q=E;const z=async r=>{const a=await(await fetch(`https://sunoapi-fitodacs-projects.vercel.app/api/clip?id=${r}`)).json();return["complete","streaming"].includes(a.status)||(await new Promise(s=>setTimeout(s,2e3)),await z(r)),a},Z=()=>{const[r,o]=d.useState(!1),[a,s]=d.useState(!1);return{createSong:async(n,p)=>{o(!0);try{const u=await(await fetch("https://sunoapi-fitodacs-projects.vercel.app/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();u.error?alert(u.error):await z(u[0].id)}catch(c){console.log("useCreateSong error",c),s(c.message)}finally{p(),o(!1)}},creatingSong:r,errorCreatingSong:a}},I=()=>{const[r,o]=d.useState(null),a=async()=>{try{const s=await fetch("https://sunoapi-fitodacs-projects.vercel.app/api/get_limit");if(!s.ok)throw new Error("Error en la solicitud");const i=await s.json();o(i)}catch(s){console.log("useGetSongs error",s)}finally{}};return d.useEffect(()=>{a()},[]),{quota:r,getQuota:a}},J=()=>{const[r,o]=d.useState(!0),[a,s]=d.useState([]),[i,n]=d.useState(null),p=async()=>{o(!0);try{const c=await fetch("https://sunoapi-fitodacs-projects.vercel.app/api/get");if(!c.ok)throw new Error("Error en la solicitud");const u=await c.json();s(u)}catch(c){console.log("useGetSongs error",c),n(c.message)}finally{o(!1)}};return d.useEffect(()=>{p()},[]),{songs:a,setSongs:s,loadingSongs:r,setLoadingSongs:o,fetchSongsError:i,fetchSongs:p}},K=()=>{const{quota:r,getQuota:o}=I(),[a,s]=d.useState({prompt:"",make_instrumental:!1,model:"chirp-v3-5|chirp-v3-0"}),{createSong:i,creatingSong:n,errorCreatingSong:p}=Z(),c=()=>{o(),console.log("propmt generated"),i(a,()=>{f(!0),h()})},[u,t]=d.useState(""),[S,w]=d.useState(""),v=d.useRef(null);d.useEffect(()=>{v.current&&v.current.play()},[v]);const{songs:m,fetchSongs:h,loadingSongs:x,setLoadingSongs:f,fetchSongsError:g}=J(),j=l=>{t(null),setTimeout(()=>{t(l),setTimeout(()=>{v.current&&v.current.play()},100)},100)};return e.jsxs(e.Fragment,{children:[e.jsx($,{className:"max-w-screen-xl mx-auto",children:e.jsx("div",{children:e.jsxs("div",{className:"w-full h-full max-w-6xl flex gap-x-20",children:[e.jsxs("div",{className:"w-3/5 space-y-6",children:[r&&e.jsx("div",{className:"text-sm flex justify-between",children:e.jsxs("div",{className:"",children:["Créditos restantes ",r.credits_left]})}),e.jsxs("div",{className:"relative space-y-6",children:[e.jsxs("fieldset",{children:[e.jsx(M,{size:"lg",minRows:10,onValueChange:l=>{a.prompt.length<=3e3&&s({...a,prompt:l})},defaultValue:a.prompt,isDisabled:n,classNames:{inputWrapper:"h-52",input:"font-extralight"}}),e.jsxs("div",{className:"text-sm mt-2 flex justify-end",children:[a.prompt.length,"/500"]}),e.jsxs("div",{className:"text-sm flex gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5",children:e.jsx("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 9.5C12.8284 9.5 13.5 8.82843 13.5 8C13.5 7.17157 12.8284 6.5 12 6.5C11.1716 6.5 10.5 7.17157 10.5 8C10.5 8.82843 11.1716 9.5 12 9.5ZM14 15H13V10.5H10V12.5H11V15H10V17H14V15Z"})}),"Ten en cuenta que el límite del prompt es de 500 caracteres."]})]}),e.jsxs("div",{className:"flex justify-between items-center gap-10",children:[e.jsx(O,{defaultSelected:a.make_instrumental,onValueChange:l=>s({...a,make_instrumental:l}),isDisabled:n,children:"Instrumental"}),e.jsx(N,{size:"lg",type:"submit",color:"primary",className:"px-20",onPress:c,isDisabled:n,children:"Crear"})]}),n&&e.jsx("div",{className:"bg-black/80 text-center inset-0 -top-6 absolute grid place-content-center z-30",children:e.jsxs("div",{children:[e.jsx(_,{className:" z-30"}),e.jsx("div",{className:"text-sm",children:"Creando la canción... por favor, ten paciencia"})]})})]}),p&&e.jsx("div",{className:"text-danger",children:"Error al crear la canción"}),e.jsxs("div",{className:y(n&&"opacity-50 pointer-events-none"),children:[e.jsx("div",{className:"mt-10 text-sm",children:"Prompts de ejemplo"}),e.jsxs("div",{className:"mt-2 space-y-3 text-sm font-extralight",children:[e.jsx("div",{className:"bg-gray-900 p-3 rounded-xl",children:"Pop, Dance Pop, Ethereal, female vocals, catchy, eletronic, 130 bpm, high quality production, perfect sounds"}),e.jsx("div",{className:"bg-gray-900 p-3 rounded-xl",children:"Dance-pop, nostalgic, intimate, emotive male voice,Synth lead, bassline. high-quality production,perfect sounds, earworm"})]})]})]}),e.jsxs("div",{className:"w-2/5 relative",children:[x&&e.jsx(_,{className:"absolute left-1/2 top-20 z-30"}),g?e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-danger",children:"Error al obtener canciones"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Canciones generadas"}),e.jsx(Q,{className:"h-[600px] mt-6",children:e.jsxs("div",{className:y("space-y-2 pb-20",x&&"opacity-30 pointer-events-none"),children:[m&&!m.length&&e.jsx("div",{className:"font-extralight",children:"No hay canciones para mostrar"}),m&&m.map(l=>e.jsxs(N,{fullWidth:!0,className:y("bg-transparent flex gap-5 items-center h-auto justify-start p-0 group"),onPress:()=>{j(l.audio_url),w(l.id)},children:[e.jsxs("div",{className:y("relative overflow-hidden rounded-2xl border-2",S===l.id?"border-primary":"border-foreground-300"),children:[e.jsx("div",{className:y("bg-black/30 inset-0 absolute flex items-center justify-center z-30 group-hover:opacity-100",S!==l.id&&"opacity-0"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-10 fill-white",children:e.jsx("path",{d:"M7.75194 5.43872L18.2596 11.5682C18.4981 11.7073 18.5787 12.0135 18.4396 12.252C18.3961 12.3265 18.3341 12.3885 18.2596 12.432L7.75194 18.5615C7.51341 18.7006 7.20725 18.62 7.06811 18.3815C7.0235 18.305 7 18.2181 7 18.1296V5.87061C7 5.59446 7.22386 5.37061 7.5 5.37061C7.58853 5.37061 7.67547 5.39411 7.75194 5.43872Z"})})}),e.jsx(q,{width:100,height:100,fallbackSrc:"https://via.placeholder.com/100x100",src:l.image_url??"https://via.placeholder.com/100x100",alt:l.title,removeWrapper:!0,classNames:{img:"object-cover"}})]}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("div",{className:"text-lg",children:l.title}),e.jsx("div",{className:"text-foreground-400 text-sm font-medium",children:l.duration?k(l.duration).format("00:00"):"--:--"})]})]},l.id))]})})]})]})]})})}),u&&e.jsx("audio",{ref:v,controls:!0,className:"w-full bottom-0 fixed",children:e.jsx("source",{src:u,type:"audio/mp3"})})]})};K.layout=r=>e.jsx(P,{children:r,pageTitle:String(V("Dashboard"))});export{K as default};
