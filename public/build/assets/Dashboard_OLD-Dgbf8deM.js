import{r as o,j as e,n as E}from"./app-Xg3MWjUp.js";import{L as _}from"./Layout-DVzgj22-.js";import{t as P}from"./translations-CBxNckOR.js";import{P as V}from"./index-BBhGX0Qn.js";import{b as j,s as v}from"./chunk-DBLREEYE-kXYMn-PH.js";import{s as k}from"./chunk-NCVCYSZZ-D6Fp1VP-.js";import{t as T}from"./chunk-ATAY3LCU-Ch8EfqI_.js";import{s as z}from"./chunk-VMWQTXAV-DD6Evupf.js";import{c as u}from"./chunk-3XVMTUU7-Dp_cF4cz.js";import{i as D}from"./chunk-NK4BRF7C-CHSWDFnF.js";import"./useColorMode-BDGS6CE1.js";import"./chunk-N2KXC5ZE-s7KBEtmC.js";import"./extend-tailwind-merge-DDA0jNcl.js";import"./chunk-XHQUSKIE-BJ4pqTDI.js";import"./template.executive.config-JRgdiSJO.js";import"./chunk-44JHHBS2-BLNJPhDT.js";import"./layout-jxVw8Mvo.js";import"./useDialog-B9TXiXAz.js";import"./useLabels-C083MLIf.js";import"./focusSafely-BGz0Gc4B.js";import"./isScrollable-BprAQSS1.js";import"./FocusScope-B94nuPOP.js";import"./VisuallyHidden-DUDGVDCO.js";import"./context-CiZxFy97.js";import"./chunk-6NL67ZRH-C6QNaIJW.js";import"./useOverlayTriggerState-CA95d7cI.js";import"./useMenuTriggerState-BXbxTzHL.js";import"./Item-CbXxQ6F7.js";import"./usePress-D8L0wOwc.js";import"./textSelection-CcPLNbaN.js";import"./useSyncRef-BzsjkglV.js";import"./getChildNodes-D9Y5kHi7.js";import"./chunk-WQVQ7P2I-D88hI9ES.js";import"./index-0WiR-nh7.js";import"./chunk-CIZQCQPA-C7Ey7jFP.js";import"./chunk-2GZPFWUB-DujZQCQ1.js";import"./useFocus-nnqdAYxR.js";import"./chunk-QXREVWCS-Bcc_oW-g.js";import"./chunk-CAFRINWI-BTDo8zfp.js";import"./index-vhBEzfuR.js";import"./chunk-NQM3AZQR-DA4sNDJM.js";import"./useFocusable-DL-dGcJ1.js";import"./useField-DZWb07f-.js";import"./useLabel-iYy-tCn_.js";import"./useFormValidationState-DKcVms6Q.js";import"./useToggleState-B8OVgiR9.js";const y=async a=>{const t=await(await fetch(`https://sunoapi-fitodacs-projects.vercel.app/api/clip?id=${a}`)).json();return["complete","streaming"].includes(t.status)||(await new Promise(r=>setTimeout(r,2e3)),await y(a)),t},L=()=>{const[a,i]=o.useState(!1),[t,r]=o.useState(!1);return{createSong:async(l,p)=>{i(!0);try{const c=await(await fetch("https://sunoapi-fitodacs-projects.vercel.app/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).json();c.error?alert(c.error):await y(c[0].id)}catch(n){console.log("useCreateSong error",n),r(n.message)}finally{p(),i(!1)}},creatingSong:a,errorCreatingSong:t}},q=()=>{const[a,i]=o.useState(null),t=async()=>{try{const r=await fetch("https://sunoapi-fitodacs-projects.vercel.app/api/get_limit");if(!r.ok)throw new Error("Error en la solicitud");const m=await r.json();i(m)}catch(r){console.log("useGetSongs error",r)}finally{}};return o.useEffect(()=>{t()},[]),{quota:a,getQuota:t}},H=()=>{const[a,i]=o.useState(!0),[t,r]=o.useState([]),[m,l]=o.useState(null),p=async()=>{i(!0);try{const n=await fetch("https://sunoapi-fitodacs-projects.vercel.app/api/get");if(!n.ok)throw new Error("Error en la solicitud");const c=await n.json();r(c)}catch(n){console.log("useGetSongs error",n),l(n.message)}finally{i(!1)}};return o.useEffect(()=>{p()},[]),{songs:t,setSongs:r,loadingSongs:a,setLoadingSongs:i,fetchSongsError:m,fetchSongs:p}},F=()=>{const{quota:a,getQuota:i}=q(),[t,r]=o.useState({prompt:"",make_instrumental:!1,model:"chirp-v3-5|chirp-v3-0"}),{createSong:m,creatingSong:l,errorCreatingSong:p}=L(),n=()=>{i(),console.log("propmt generated"),m(t,()=>{N(!0),S()})},[c,h]=o.useState(""),[x,w]=o.useState(""),d=o.useRef(null);o.useEffect(()=>{d.current&&d.current.play()},[d]);const{songs:g,fetchSongs:S,loadingSongs:f,setLoadingSongs:N,fetchSongsError:b}=H(),C=s=>{h(null),setTimeout(()=>{h(s),setTimeout(()=>{d.current&&d.current.play()},100)},100)};return e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"max-w-screen-xl mx-auto",children:e.jsx("div",{children:e.jsxs("div",{className:"w-full h-full max-w-6xl flex gap-x-20",children:[e.jsxs("div",{className:"w-3/5 space-y-6",children:[a&&e.jsx("div",{className:"text-sm flex justify-between",children:e.jsxs("div",{className:"",children:["Créditos restantes ",a.credits_left]})}),e.jsxs("div",{className:"relative space-y-6",children:[e.jsxs("fieldset",{children:[e.jsx(T,{size:"lg",minRows:10,onValueChange:s=>{t.prompt.length<=3e3&&r({...t,prompt:s})},defaultValue:t.prompt,isDisabled:l,classNames:{inputWrapper:"h-52",input:"font-extralight"}}),e.jsxs("div",{className:"text-sm mt-2 flex justify-end",children:[t.prompt.length,"/500"]}),e.jsxs("div",{className:"text-sm flex gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5",children:e.jsx("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 9.5C12.8284 9.5 13.5 8.82843 13.5 8C13.5 7.17157 12.8284 6.5 12 6.5C11.1716 6.5 10.5 7.17157 10.5 8C10.5 8.82843 11.1716 9.5 12 9.5ZM14 15H13V10.5H10V12.5H11V15H10V17H14V15Z"})}),"Ten en cuenta que el límite del prompt es de 500 caracteres."]})]}),e.jsxs("div",{className:"flex justify-between items-center gap-10",children:[e.jsx(z,{defaultSelected:t.make_instrumental,onValueChange:s=>r({...t,make_instrumental:s}),isDisabled:l,children:"Instrumental"}),e.jsx(j,{size:"lg",type:"submit",color:"primary",className:"px-20",onPress:n,isDisabled:l,children:"Crear"})]}),l&&e.jsx("div",{className:"bg-black/80 text-center inset-0 -top-6 absolute grid place-content-center z-30",children:e.jsxs("div",{children:[e.jsx(v,{className:" z-30"}),e.jsx("div",{className:"text-sm",children:"Creando la canción... por favor, ten paciencia"})]})})]}),p&&e.jsx("div",{className:"text-danger",children:"Error al crear la canción"}),e.jsxs("div",{className:u(l&&"opacity-50 pointer-events-none"),children:[e.jsx("div",{className:"mt-10 text-sm",children:"Prompts de ejemplo"}),e.jsxs("div",{className:"mt-2 space-y-3 text-sm font-extralight",children:[e.jsx("div",{className:"bg-gray-900 p-3 rounded-xl",children:"Pop, Dance Pop, Ethereal, female vocals, catchy, eletronic, 130 bpm, high quality production, perfect sounds"}),e.jsx("div",{className:"bg-gray-900 p-3 rounded-xl",children:"Dance-pop, nostalgic, intimate, emotive male voice,Synth lead, bassline. high-quality production,perfect sounds, earworm"})]})]})]}),e.jsxs("div",{className:"w-2/5 relative",children:[f&&e.jsx(v,{className:"absolute left-1/2 top-20 z-30"}),b?e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-danger",children:"Error al obtener canciones"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Canciones generadas"}),e.jsx(k,{className:"h-[600px] mt-6",children:e.jsxs("div",{className:u("space-y-2 pb-20",f&&"opacity-30 pointer-events-none"),children:[g&&!g.length&&e.jsx("div",{className:"font-extralight",children:"No hay canciones para mostrar"}),g&&g.map(s=>e.jsxs(j,{fullWidth:!0,className:u("bg-transparent flex gap-5 items-center h-auto justify-start p-0 group"),onPress:()=>{C(s.audio_url),w(s.id)},children:[e.jsxs("div",{className:u("relative overflow-hidden rounded-2xl border-2",x===s.id?"border-primary":"border-foreground-300"),children:[e.jsx("div",{className:u("bg-black/30 inset-0 absolute flex items-center justify-center z-30 group-hover:opacity-100",x!==s.id&&"opacity-0"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-10 fill-white",children:e.jsx("path",{d:"M7.75194 5.43872L18.2596 11.5682C18.4981 11.7073 18.5787 12.0135 18.4396 12.252C18.3961 12.3265 18.3341 12.3885 18.2596 12.432L7.75194 18.5615C7.51341 18.7006 7.20725 18.62 7.06811 18.3815C7.0235 18.305 7 18.2181 7 18.1296V5.87061C7 5.59446 7.22386 5.37061 7.5 5.37061C7.58853 5.37061 7.67547 5.39411 7.75194 5.43872Z"})})}),e.jsx(D,{width:100,height:100,fallbackSrc:"https://via.placeholder.com/100x100",src:s.image_url??"https://via.placeholder.com/100x100",alt:s.title,removeWrapper:!0,classNames:{img:"object-cover"}})]}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("div",{className:"text-lg",children:s.title}),e.jsx("div",{className:"text-foreground-400 text-sm font-medium",children:s.duration?E(s.duration).format("00:00"):"--:--"})]})]},s.id))]})})]})]})]})})}),c&&e.jsx("audio",{ref:d,controls:!0,className:"w-full bottom-0 fixed",children:e.jsx("source",{src:c,type:"audio/mp3"})})]})};F.layout=a=>e.jsx(_,{children:a,pageTitle:String(P("Dashboard"))});export{F as default};
