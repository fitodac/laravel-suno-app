import{$ as ne,a as X,b as z}from"./textSelection-CcPLNbaN.js";import{$ as ae}from"./context-CiZxFy97.js";import{_ as V,h as ie,i as oe}from"./chunk-XHQUSKIE-BJ4pqTDI.js";import{w as se,f as R,t as le,x as ue,j as D,r as C,y as fe,s as I,z as W,u as B,a as Q,l as ce}from"./focusSafely-BGz0Gc4B.js";import{r as x}from"./app-Xg3MWjUp.js";import{$ as de}from"./useSyncRef-BzsjkglV.js";const ge=x.createContext({isNative:!0,open:Te,useHref:t=>t});function pe(){return x.useContext(ge)}function A(t,i,o=!0){var l,u;let{metaKey:g,ctrlKey:d,altKey:$,shiftKey:v}=i;se()&&(!((u=window.event)===null||u===void 0||(l=u.type)===null||l===void 0)&&l.startsWith("key"))&&t.target==="_blank"&&(R()?g=!0:d=!0);let E=le()&&R()&&!ue()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:g,ctrlKey:d,altKey:$,shiftKey:v}):new MouseEvent("click",{metaKey:g,ctrlKey:d,altKey:$,shiftKey:v,bubbles:!0,cancelable:!0});A.isOpening=o,D(t),t.dispatchEvent(E),A.isOpening=!1}A.isOpening=!1;function ve(t,i){if(t instanceof HTMLAnchorElement)i(t);else if(t.hasAttribute("data-href")){let o=document.createElement("a");o.href=t.getAttribute("data-href"),t.hasAttribute("data-target")&&(o.target=t.getAttribute("data-target")),t.hasAttribute("data-rel")&&(o.rel=t.getAttribute("data-rel")),t.hasAttribute("data-download")&&(o.download=t.getAttribute("data-download")),t.hasAttribute("data-ping")&&(o.ping=t.getAttribute("data-ping")),t.hasAttribute("data-referrer-policy")&&(o.referrerPolicy=t.getAttribute("data-referrer-policy")),t.appendChild(o),i(o),t.removeChild(o)}}function Te(t,i){ve(t,o=>A(o,i))}function Oe(t){return{"data-href":t.href,"data-target":t.target,"data-rel":t.rel,"data-download":t.download,"data-ping":t.ping,"data-referrer-policy":t.referrerPolicy}}function ke(t){let i=pe();return{href:t!=null&&t.href?i.useHref(t==null?void 0:t.href):void 0,target:t==null?void 0:t.target,rel:t==null?void 0:t.rel,download:t==null?void 0:t.download,ping:t==null?void 0:t.ping,referrerPolicy:t==null?void 0:t.referrerPolicy}}function ye(t){let i=x.useContext(ae);if(i){let{register:o,...l}=i;t=Q(l,t),o()}return de(i,t.ref),t}var Y=new WeakMap;class U{continuePropagation(){V(this,Y,!1)}get shouldStopPropagation(){return ie(this,Y)}constructor(i,o,l,u){oe(this,Y,{writable:!0,value:void 0}),V(this,Y,!0);var g;let d=(g=u==null?void 0:u.target)!==null&&g!==void 0?g:l.currentTarget;const $=d==null?void 0:d.getBoundingClientRect();let v,E=0,T,L=null;l.clientX!=null&&l.clientY!=null&&(T=l.clientX,L=l.clientY),$&&(T!=null&&L!=null?(v=T-$.left,E=L-$.top):(v=$.width/2,E=$.height/2)),this.type=i,this.pointerType=o,this.target=l.currentTarget,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.x=v,this.y=E}}const j=Symbol("linkClicked");function Me(t){let{onPress:i,onPressChange:o,onPressStart:l,onPressEnd:u,onPressUp:g,isDisabled:d,isPressed:$,preventFocusOnPress:v,shouldCancelOnPointerExit:E,allowTextSelectionOnPress:T,ref:L,...ee}=ye(t),[te,N]=x.useState(!1),S=x.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:m,removeAllGlobalListeners:w}=ne(),P=C((e,s)=>{let y=S.current;if(d||y.didFirePressStart)return!1;let a=!0;if(y.isTriggeringEvent=!0,l){let f=new U("pressstart",s,e);l(f),a=f.shouldStopPropagation}return o&&o(!0),y.isTriggeringEvent=!1,y.didFirePressStart=!0,N(!0),a}),p=C((e,s,y=!0)=>{let a=S.current;if(!a.didFirePressStart)return!1;a.ignoreClickAfterPress=!0,a.didFirePressStart=!1,a.isTriggeringEvent=!0;let f=!0;if(u){let r=new U("pressend",s,e);u(r),f=r.shouldStopPropagation}if(o&&o(!1),N(!1),i&&y&&!d){let r=new U("press",s,e);i(r),f&&(f=r.shouldStopPropagation)}return a.isTriggeringEvent=!1,f}),O=C((e,s)=>{let y=S.current;if(d)return!1;if(g){y.isTriggeringEvent=!0;let a=new U("pressup",s,e);return g(a),y.isTriggeringEvent=!1,a.shouldStopPropagation}return!0}),K=C(e=>{let s=S.current;s.isPressed&&s.target&&(s.isOverTarget&&s.pointerType!=null&&p(h(s.target,e),s.pointerType,!1),s.isPressed=!1,s.isOverTarget=!1,s.activePointerId=null,s.pointerType=null,w(),T||X(s.target))}),_=C(e=>{E&&K(e)}),re=x.useMemo(()=>{let e=S.current,s={onKeyDown(a){if(H(a.nativeEvent,a.currentTarget)&&a.currentTarget.contains(a.target)){var f;J(a.target,a.key)&&a.preventDefault();let r=!0;if(!e.isPressed&&!a.repeat){e.target=a.currentTarget,e.isPressed=!0,r=P(a,"keyboard");let n=a.currentTarget,c=k=>{H(k,n)&&!k.repeat&&n.contains(k.target)&&e.target&&O(h(e.target,k),"keyboard")};m(I(a.currentTarget),"keyup",ce(c,y),!0)}r&&a.stopPropagation(),a.metaKey&&R()&&((f=e.metaKeyEvents)===null||f===void 0||f.set(a.key,a.nativeEvent))}else a.key==="Meta"&&(e.metaKeyEvents=new Map)},onClick(a){if(!(a&&!a.currentTarget.contains(a.target))&&a&&a.button===0&&!e.isTriggeringEvent&&!A.isOpening){let f=!0;if(d&&a.preventDefault(),!e.ignoreClickAfterPress&&!e.ignoreEmulatedMouseEvents&&!e.isPressed&&(e.pointerType==="virtual"||W(a.nativeEvent))){!d&&!v&&D(a.currentTarget);let r=P(a,"virtual"),n=O(a,"virtual"),c=p(a,"virtual");f=r&&n&&c}e.ignoreEmulatedMouseEvents=!1,e.ignoreClickAfterPress=!1,f&&a.stopPropagation()}}},y=a=>{var f;if(e.isPressed&&e.target&&H(a,e.target)){var r;J(a.target,a.key)&&a.preventDefault();let c=a.target;p(h(e.target,a),"keyboard",e.target.contains(c)),w(),a.key!=="Enter"&&G(e.target)&&e.target.contains(c)&&!a[j]&&(a[j]=!0,A(e.target,a,!1)),e.isPressed=!1,(r=e.metaKeyEvents)===null||r===void 0||r.delete(a.key)}else if(a.key==="Meta"&&(!((f=e.metaKeyEvents)===null||f===void 0)&&f.size)){var n;let c=e.metaKeyEvents;e.metaKeyEvents=void 0;for(let k of c.values())(n=e.target)===null||n===void 0||n.dispatchEvent(new KeyboardEvent("keyup",k))}};if(typeof PointerEvent<"u"){s.onPointerDown=n=>{if(n.button!==0||!n.currentTarget.contains(n.target))return;if(fe(n.nativeEvent)){e.pointerType="virtual";return}F(n.currentTarget)&&n.preventDefault(),e.pointerType=n.pointerType;let c=!0;e.isPressed||(e.isPressed=!0,e.isOverTarget=!0,e.activePointerId=n.pointerId,e.target=n.currentTarget,!d&&!v&&D(n.currentTarget),T||z(e.target),c=P(n,e.pointerType),m(I(n.currentTarget),"pointermove",a,!1),m(I(n.currentTarget),"pointerup",f,!1),m(I(n.currentTarget),"pointercancel",r,!1)),c&&n.stopPropagation()},s.onMouseDown=n=>{n.currentTarget.contains(n.target)&&n.button===0&&(F(n.currentTarget)&&n.preventDefault(),n.stopPropagation())},s.onPointerUp=n=>{!n.currentTarget.contains(n.target)||e.pointerType==="virtual"||n.button===0&&M(n,n.currentTarget)&&O(n,e.pointerType||n.pointerType)};let a=n=>{n.pointerId===e.activePointerId&&(e.target&&M(n,e.target)?!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,P(h(e.target,n),e.pointerType)):e.target&&e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,p(h(e.target,n),e.pointerType,!1),_(n)))},f=n=>{n.pointerId===e.activePointerId&&e.isPressed&&n.button===0&&e.target&&(M(n,e.target)&&e.pointerType!=null?p(h(e.target,n),e.pointerType):e.isOverTarget&&e.pointerType!=null&&p(h(e.target,n),e.pointerType,!1),e.isPressed=!1,e.isOverTarget=!1,e.activePointerId=null,e.pointerType=null,w(),T||X(e.target))},r=n=>{K(n)};s.onDragStart=n=>{n.currentTarget.contains(n.target)&&K(n)}}else{s.onMouseDown=r=>{if(r.button!==0||!r.currentTarget.contains(r.target))return;if(F(r.currentTarget)&&r.preventDefault(),e.ignoreEmulatedMouseEvents){r.stopPropagation();return}e.isPressed=!0,e.isOverTarget=!0,e.target=r.currentTarget,e.pointerType=W(r.nativeEvent)?"virtual":"mouse",!d&&!v&&D(r.currentTarget),P(r,e.pointerType)&&r.stopPropagation(),m(I(r.currentTarget),"mouseup",a,!1)},s.onMouseEnter=r=>{if(!r.currentTarget.contains(r.target))return;let n=!0;e.isPressed&&!e.ignoreEmulatedMouseEvents&&e.pointerType!=null&&(e.isOverTarget=!0,n=P(r,e.pointerType)),n&&r.stopPropagation()},s.onMouseLeave=r=>{if(!r.currentTarget.contains(r.target))return;let n=!0;e.isPressed&&!e.ignoreEmulatedMouseEvents&&e.pointerType!=null&&(e.isOverTarget=!1,n=p(r,e.pointerType,!1),_(r)),n&&r.stopPropagation()},s.onMouseUp=r=>{r.currentTarget.contains(r.target)&&!e.ignoreEmulatedMouseEvents&&r.button===0&&O(r,e.pointerType||"mouse")};let a=r=>{if(r.button===0){if(e.isPressed=!1,w(),e.ignoreEmulatedMouseEvents){e.ignoreEmulatedMouseEvents=!1;return}e.target&&M(r,e.target)&&e.pointerType!=null?p(h(e.target,r),e.pointerType):e.target&&e.isOverTarget&&e.pointerType!=null&&p(h(e.target,r),e.pointerType,!1),e.isOverTarget=!1}};s.onTouchStart=r=>{if(!r.currentTarget.contains(r.target))return;let n=$e(r.nativeEvent);if(!n)return;e.activePointerId=n.identifier,e.ignoreEmulatedMouseEvents=!0,e.isOverTarget=!0,e.isPressed=!0,e.target=r.currentTarget,e.pointerType="touch",!d&&!v&&D(r.currentTarget),T||z(e.target),P(b(e.target,r),e.pointerType)&&r.stopPropagation(),m(B(r.currentTarget),"scroll",f,!0)},s.onTouchMove=r=>{if(!r.currentTarget.contains(r.target))return;if(!e.isPressed){r.stopPropagation();return}let n=q(r.nativeEvent,e.activePointerId),c=!0;n&&M(n,r.currentTarget)?!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,c=P(b(e.target,r),e.pointerType)):e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,c=p(b(e.target,r),e.pointerType,!1),_(b(e.target,r))),c&&r.stopPropagation()},s.onTouchEnd=r=>{if(!r.currentTarget.contains(r.target))return;if(!e.isPressed){r.stopPropagation();return}let n=q(r.nativeEvent,e.activePointerId),c=!0;n&&M(n,r.currentTarget)&&e.pointerType!=null?(O(b(e.target,r),e.pointerType),c=p(b(e.target,r),e.pointerType)):e.isOverTarget&&e.pointerType!=null&&(c=p(b(e.target,r),e.pointerType,!1)),c&&r.stopPropagation(),e.isPressed=!1,e.activePointerId=null,e.isOverTarget=!1,e.ignoreEmulatedMouseEvents=!0,e.target&&!T&&X(e.target),w()},s.onTouchCancel=r=>{r.currentTarget.contains(r.target)&&(r.stopPropagation(),e.isPressed&&K(b(e.target,r)))};let f=r=>{e.isPressed&&r.target.contains(e.target)&&K({currentTarget:e.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};s.onDragStart=r=>{r.currentTarget.contains(r.target)&&K(r)}}return s},[m,d,v,w,T,K,_,p,P,O]);return x.useEffect(()=>()=>{var e;T||X((e=S.current.target)!==null&&e!==void 0?e:void 0)},[T]),{isPressed:$||te,pressProps:Q(ee,re)}}function G(t){return t.tagName==="A"&&t.hasAttribute("href")}function H(t,i){const{key:o,code:l}=t,u=i,g=u.getAttribute("role");return(o==="Enter"||o===" "||o==="Spacebar"||l==="Space")&&!(u instanceof B(u).HTMLInputElement&&!Z(u,o)||u instanceof B(u).HTMLTextAreaElement||u.isContentEditable)&&!((g==="link"||!g&&G(u))&&o!=="Enter")}function $e(t){const{targetTouches:i}=t;return i.length>0?i[0]:null}function q(t,i){const o=t.changedTouches;for(let l=0;l<o.length;l++){const u=o[l];if(u.identifier===i)return u}return null}function b(t,i){let o=0,l=0;return i.targetTouches&&i.targetTouches.length===1&&(o=i.targetTouches[0].clientX,l=i.targetTouches[0].clientY),{currentTarget:t,shiftKey:i.shiftKey,ctrlKey:i.ctrlKey,metaKey:i.metaKey,altKey:i.altKey,clientX:o,clientY:l}}function h(t,i){let o=i.clientX,l=i.clientY;return{currentTarget:t,shiftKey:i.shiftKey,ctrlKey:i.ctrlKey,metaKey:i.metaKey,altKey:i.altKey,clientX:o,clientY:l}}function Pe(t){let i=0,o=0;return t.width!==void 0?i=t.width/2:t.radiusX!==void 0&&(i=t.radiusX),t.height!==void 0?o=t.height/2:t.radiusY!==void 0&&(o=t.radiusY),{top:t.clientY-o,right:t.clientX+i,bottom:t.clientY+o,left:t.clientX-i}}function he(t,i){return!(t.left>i.right||i.left>t.right||t.top>i.bottom||i.top>t.bottom)}function M(t,i){let o=i.getBoundingClientRect(),l=Pe(t);return he(o,l)}function F(t){return!(t instanceof HTMLElement)||!t.hasAttribute("draggable")}function J(t,i){return t instanceof HTMLInputElement?!Z(t,i):t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!G(t)}const be=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Z(t,i){return t.type==="checkbox"||t.type==="radio"?i===" ":be.has(t.type)}export{ke as $,pe as a,Me as b,A as c,Oe as d};
